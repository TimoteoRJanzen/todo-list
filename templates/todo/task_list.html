{% extends "base.html" %}

{% block title %}TODO list{% endblock %}

{% block content %}

<div class="d-flex justify-content-between align-items-center mb-4">
  <h1 class="mb-0">TODO list</h1>

  <a href="{% url 'todo:todo-create' %}" class="btn btn-primary">
    Add task
  </a>
</div>

{% for task in task_list %}
  <div class="border-bottom py-3">
    <div class="d-flex justify-content-between align-items-start">

      <!-- LEFT SIDE -->
      <div>
        <strong>{{ task.content }}</strong>

        {% if task.done %}
          <span class="text-success ml-2">Done</span>
        {% else %}
          <span class="text-danger ml-2">Not done</span>
        {% endif %}

        <p class="mb-1 text-muted">
          Created: {{ task.created_at|date:"F j, Y, P" }}
          {% if task.deadline %}
            <br>
            Deadline: {{ task.deadline|date:"F j, Y, P" }}
          {% endif %}
        </p>

        <p class="mb-0">
          Tags:
          {% for tag in task.tags.all %}
            {{ tag.name }}
          {% empty %}
            â€”
          {% endfor %}

          <a href="{% url 'todo:todo-update' task.pk %}" class="ml-2">
            Update
          </a>
          <a href="{% url 'todo:todo-delete' task.pk %}">
            Delete
          </a>
        </p>
      </div>

      <!-- RIGHT SIDE -->
      <form method="post" action="{% url 'todo:task-toggle' task.pk %}">
        {% csrf_token %}
        {% if task.done %}
          <button class="btn btn-secondary">
            Undo
          </button>
        {% else %}
          <button class="btn btn-success">
            Complete
          </button>
        {% endif %}
      </form>

    </div>
  </div>
{% empty %}
  <p>No tasks yet.</p>
{% endfor %}

{% endblock %}
